"use strict";(self.webpackChunknantralplatform_docs=self.webpackChunknantralplatform_docs||[]).push([[9480],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),p=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=p(e.components);return a.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,u=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),c=p(n),m=r,h=c["".concat(u,".").concat(m)]||c[m]||d[m]||o;return n?a.createElement(h,l(l({ref:t},s),{},{components:n})):a.createElement(h,l({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=c;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},2360:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(7294),r=n(6010),o="tabItem_OmH5";function l(e){var t=e.children,n=e.hidden,l=e.className;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,l),hidden:n},t)}},9877:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(7462),r=n(7294),o=n(2389),l=n(7392),i=n(7094),u=n(2466),p=n(6010),s="tabList_uSqn",d="tabItem_LplD";function c(e){var t,n,o,c=e.lazy,m=e.block,h=e.defaultValue,f=e.values,y=e.groupId,k=e.className,v=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),g=null!=f?f:v.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),b=(0,l.l)(g,(function(e,t){return e.value===t.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var N=null===h?h:null!=(t=null!=h?h:null==(n=v.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(o=v[0])?void 0:o.props.value;if(null!==N&&!g.some((function(e){return e.value===N})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+N+'" but none of its children has the corresponding value. Available values are: '+g.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var w=(0,i.U)(),C=w.tabGroupChoices,O=w.setTabGroupChoices,j=(0,r.useState)(N),T=j[0],E=j[1],P=[],_=(0,u.o5)().blockElementScrollPositionUntilNextRender;if(null!=y){var D=C[y];null!=D&&D!==T&&g.some((function(e){return e.value===D}))&&E(D)}var x=function(e){var t=e.currentTarget,n=P.indexOf(t),a=g[n].value;a!==T&&(_(t),E(a),null!=y&&O(y,a))},S=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=P.indexOf(e.currentTarget)+1;n=P[a]||P[0];break;case"ArrowLeft":var r=P.indexOf(e.currentTarget)-1;n=P[r]||P[P.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:(0,p.Z)("tabs-container",s)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,p.Z)("tabs",{"tabs--block":m},k)},g.map((function(e){var t=e.value,n=e.label,o=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:T===t?0:-1,"aria-selected":T===t,key:t,ref:function(e){return P.push(e)},onKeyDown:S,onFocus:x,onClick:x},o,{className:(0,p.Z)("tabs__item",d,null==o?void 0:o.className,{"tabs__item--active":T===t})}),null!=n?n:t)}))),c?(0,r.cloneElement)(v.filter((function(e){return e.props.value===T}))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},v.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==T})}))))}function m(e){var t=(0,o.Z)();return r.createElement(c,(0,a.Z)({key:String(t)},e))}},9693:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return u},default:function(){return m},frontMatter:function(){return i},metadata:function(){return p},toc:function(){return d}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),l=(n(9877),n(2360),["components"]),i={title:"How to use Django",sidebar_position:4},u="How to use Django",p={unversionedId:"learning/django",id:"learning/django",title:"How to use Django",description:"Now that Nantral Platform development environment is installed, we'll take a closer look to the commands you will have",source:"@site/docs/learning/django.md",sourceDirName:"learning",slug:"/learning/django",permalink:"/docs/learning/django",draft:!1,editUrl:"https://github.com/nantral-platform/nantralPlatform/tree/master/docs/docs/learning/django.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"How to use Django",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"How to use Python Virtualenv",permalink:"/docs/learning/virtualenv"},next:{title:"How to use React",permalink:"/docs/learning/react"}},s={},d=[{value:"1. Launch the server",id:"1-launch-the-server",level:2},{value:"2. Pull last updates",id:"2-pull-last-updates",level:2},{value:"3. Migrations",id:"3-migrations",level:2},{value:"4. Creating a new server app",id:"4-creating-a-new-server-app",level:2}],c={toc:d};function m(e){var t=e.components,n=(0,r.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"how-to-use-django"},"How to use Django"),(0,o.kt)("p",null,"Now that Nantral Platform development environment is installed, we'll take a closer look to the commands you will have\nto use each time you developp something on the application."),(0,o.kt)("h2",{id:"1-launch-the-server"},"1. Launch the server"),(0,o.kt)("p",null,"Suppose that during your coffee break, Windows made an update an restarted your computer. How to run the server again whitout reinstalling erveything like above ?"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"If you use Github Desktop, open it, then open the repository in VScode. Else, directly open the directory in VScode."),(0,o.kt)("li",{parentName:"ol"},"Open a new terminal in VScode if there is no one (",(0,o.kt)("em",{parentName:"li"},"Terminal")," tab > ",(0,o.kt)("em",{parentName:"li"},"New terminal"),")"),(0,o.kt)("li",{parentName:"ol"},"Go into the ",(0,o.kt)("inlineCode",{parentName:"li"},"backend")," folder with ",(0,o.kt)("inlineCode",{parentName:"li"},"cd")," command"),(0,o.kt)("li",{parentName:"ol"},"Activate your virtualenv (see the dedicated section below, at the end)"),(0,o.kt)("li",{parentName:"ol"},"Visit your local website at ",(0,o.kt)("a",{parentName:"li",href:"http://localhost:8000"},"http://localhost:8000"),", or shutdown the server with ",(0,o.kt)("kbd",null,"CTRL")," + ",(0,o.kt)("kbd",null,"C"),".")),(0,o.kt)("h2",{id:"2-pull-last-updates"},"2. Pull last updates"),(0,o.kt)("p",null,"When someone else make some updates, you make a ",(0,o.kt)("inlineCode",{parentName:"p"},"pull")," with git to update your local copy of nantral platform (e.g. with Github Desktop, or git in VScode, or git in command line). When you pull last updates, you will probably have to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"update your python dependencies:")," in the ",(0,o.kt)("inlineCode",{parentName:"li"},"backend")," folder, run ",(0,o.kt)("inlineCode",{parentName:"li"},"pip3 install -r requirements.txt")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"update your database:")," in the ",(0,o.kt)("inlineCode",{parentName:"li"},"backend")," folder, run ",(0,o.kt)("inlineCode",{parentName:"li"},"python3 manage.py migrate")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"update your React dependencies:")," in the ",(0,o.kt)("inlineCode",{parentName:"li"},"frontend")," folder, run ",(0,o.kt)("inlineCode",{parentName:"li"},"npm install")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"update your compiled React files:")," in the ",(0,o.kt)("inlineCode",{parentName:"li"},"frontend")," folder, run ",(0,o.kt)("inlineCode",{parentName:"li"},"npm run dev"))),(0,o.kt)("h2",{id:"3-migrations"},"3. Migrations"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Whenever you make a change to your database's structure (basically each time you modify one of the ",(0,o.kt)("inlineCode",{parentName:"li"},"models.py")," file), you need to save the modifications of your database in a file so as to other users can know the database modifications. In the ",(0,o.kt)("inlineCode",{parentName:"li"},"backend")," folder, run ",(0,o.kt)("inlineCode",{parentName:"li"},"python3 manage.py makemigrations")," to automatically create these files"),(0,o.kt)("li",{parentName:"ul"},"Then, you can apply these modifications to your own database by running ",(0,o.kt)("inlineCode",{parentName:"li"},"python3 manage.py migrate"))),(0,o.kt)("p",null,"Some good practices:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The migration files are saved in the ",(0,o.kt)("inlineCode",{parentName:"li"},"migrations")," folder in each app. Try to rename the migrations scripts to something more understandable for a human. Example : rename ",(0,o.kt)("inlineCode",{parentName:"li"},"migration01.py")," to ",(0,o.kt)("inlineCode",{parentName:"li"},"create_news_model_alter_clubs.py")),(0,o.kt)("li",{parentName:"ul"},"Try also to merge migrations into one migration as much as possible."),(0,o.kt)("li",{parentName:"ul"},"Be careful: you can't change your migration files once you migrate your database. If you want to merge them before pushing your updates to the server for example, you'll have to destroy your database (simply delete the ",(0,o.kt)("inlineCode",{parentName:"li"},"db.sqlite3")," file).")),(0,o.kt)("h2",{id:"4-creating-a-new-server-app"},"4. Creating a new server app"),(0,o.kt)("p",null,'In django, all functionnalities are separeted in "apps". Each "app" correspond to a directory in the ',(0,o.kt)("inlineCode",{parentName:"p"},"server/apps")," folder."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"To create a new app in the django server, use ",(0,o.kt)("inlineCode",{parentName:"li"},"python manage.py startapp app_name"),". This will create a new folder with the app name you chose."),(0,o.kt)("li",{parentName:"ul"},"Then move the app folder to the main ",(0,o.kt)("inlineCode",{parentName:"li"},"apps")," folder, so as to have all apps in the same place."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"In your new app folder:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Create or update a ",(0,o.kt)("inlineCode",{parentName:"li"},"urls.py")," script inside the folder. Base this script on other ",(0,o.kt)("inlineCode",{parentName:"li"},"urls.py")," you can find in other apps"),(0,o.kt)("li",{parentName:"ul"},"Update the ",(0,o.kt)("inlineCode",{parentName:"li"},"apps.py")," script, by replacing ",(0,o.kt)("inlineCode",{parentName:"li"},"name = 'app_name'")," by ",(0,o.kt)("inlineCode",{parentName:"li"},"name = 'apps.app_name'")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Then in the ",(0,o.kt)("inlineCode",{parentName:"strong"},"server/config")," folder:"),(0,o.kt)("em",{parentName:"li"}," In the ",(0,o.kt)("inlineCode",{parentName:"em"},"urls.py")," script, add a namespace for your app like this: ",(0,o.kt)("inlineCode",{parentName:"em"},"url('app_name/', include('apps.app_name.urls', namespace='app_name')),"),". This will link the url router to your urls.py script in the app you created.\n")," Finally add the app in ",(0,o.kt)("inlineCode",{parentName:"li"},"settings/base.py"),":\n",(0,o.kt)("inlineCode",{parentName:"li"},"COMMON_APPS = [ 'apps.app_name', ]"),"\nSome defaults tables have been added in your database: run the migrations (see section 3), and then run the server!")))}m.isMDXComponent=!0}}]);