"use strict";(self.webpackChunknantralplatform_docs=self.webpackChunknantralplatform_docs||[]).push([[7955],{41:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var r=a(5893),t=a(1151);a(4866),a(5162);const s={sidebar_position:3,description:"The Web framework for perfectionists with deadlines."},i="Django",o={id:"dev/guides/frameworks/django",title:"Django",description:"The Web framework for perfectionists with deadlines.",source:"@site/docs/dev/guides/frameworks/django.md",sourceDirName:"dev/guides/frameworks",slug:"/dev/guides/frameworks/django",permalink:"/dev/guides/frameworks/django",draft:!1,unlisted:!1,editUrl:"https://github.com/3cn-ecn/nantralPlatform/tree/master/docs/docs/dev/guides/frameworks/django.md",tags:[],version:"current",lastUpdatedBy:"Alexis Delage",lastUpdatedAt:1706649003,formattedLastUpdatedAt:"Jan 30, 2024",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"The Web framework for perfectionists with deadlines."},sidebar:"sidebar",previous:{title:"Frameworks",permalink:"/dev/guides/frameworks/"},next:{title:"React",permalink:"/dev/guides/frameworks/react"}},l={},c=[{value:"Basic commands",id:"basic-commands",level:2},{value:"Database, models and migrations",id:"database-models-and-migrations",level:2},{value:"Create a new app",id:"create-a-new-app",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components},{Details:a}=n;return a||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"django",children:"Django"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Learn/Server-side/Django",children:"Recommended Tutorial (MDN)"})})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://docs.djangoproject.com/",children:"Official Documentation"})})," (tip: the downloadable PDF is easier to use)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://github.com/django/django",children:"Source Code"})})," (tip: on Github, use the ",(0,r.jsx)("kbd",{children:"."})," shortcut to open the code in VSCode)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"basic-commands",children:"Basic commands"}),"\n",(0,r.jsx)(n.admonition,{title:"Reminder",type:"caution",children:(0,r.jsxs)(n.p,{children:["All the commands for django should be run from the ",(0,r.jsx)(n.code,{children:"backend"})," directory."]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Start the server:"})," (the website is then accessible at ",(0,r.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"}),")","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run start\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Run the django tests:"})," (optionally for one app only)","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run test [app_label]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create the database migration files:"})," (optionally for one app only)","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run makemigrations [app_label]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Apply the migration files and update your database:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run migrate\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Run any ",(0,r.jsx)(n.code,{children:"django"})," command:"]})," (this command replace ",(0,r.jsx)(n.code,{children:"django-admin"})," or ",(0,r.jsx)(n.code,{children:"python manage.py"}),"):","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run django <command>\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"database-models-and-migrations",children:"Database, models and migrations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The structure of the database is defined in the ",(0,r.jsx)(n.code,{children:"models.py"})," files: each\n",(0,r.jsx)(n.em,{children:"django app"})," can have multiple tables, defined as python classes."]}),"\n",(0,r.jsxs)(n.li,{children:["Whenever you make a change to your database's structure (basically each time\nyou modify one of the ",(0,r.jsx)(n.code,{children:"models.py"})," file), you need to create a migration file\nto detect the changes in the database structure. Hopefully, django can create\nthese files automatically with this command (replace ",(0,r.jsx)(n.code,{children:"[app_label]"})," with the\nlabel of your django app):","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run makemigrations [app_label]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Then, you can apply these changes to your own database by running:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run migrate\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Some good practices",type:"info",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Try to ",(0,r.jsx)(n.strong,{children:"merge"})," migration files into one file as much as possible: we\ntry to have as few migration files as possible (to do so, just ",(0,r.jsx)(n.em,{children:"unapply"}),"\nyour last migrations files, delete them, and recreate a new migration file)."]}),"\n",(0,r.jsxs)(n.li,{children:["Be careful: you can't change migration files once they are uploaded to\nthe ",(0,r.jsx)(n.code,{children:"master"})," branch on the server."]}),"\n"]})}),"\n",(0,r.jsxs)(a,{children:[(0,r.jsx)("summary",{children:"More on migrations..."}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Write custom migrations"}),": you can write custom migrations, for example\nto transfer or copy data from one ",(0,r.jsx)(n.em,{children:"table"})," to another. First, create an empty\nmigration file with:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run makemigrations <app_label> --empty --name <file_name>\n"})}),"\n","Then, go to the ",(0,r.jsx)(n.code,{children:"migrations"})," directory, and edit the new created file\nto implement your custom migrations (see ",(0,r.jsx)(n.a,{href:"https://docs.djangoproject.com/en/4.1/howto/writing-migrations/",children:"this documentation"}),"\nabout how to write custom migrations)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Apply only some migrations"}),": you can specify\nwhich migration files to apply by specifying the app or the file:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run migrate <app_label> [migration_name]\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unapply a migration"}),": you can unapply a migration and reverse your database\nto the previous state. This is very useful when you want to merge migrations,\nfor example. To do so, just run:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run migrate <app_label> <migration_name>\n"})}),"\n","where ",(0,r.jsx)(n.code,{children:"<migration_name>"})," is the name of the migration just before the one\nyou want to unapply: this will reverse the state of your database to the state\njust after this migration. Note that you can also only specify the number of the\nmigration, and not the full name (for example, ",(0,r.jsx)(n.code,{children:"pipenv run migrate event 0004"}),"\nworks)."]}),"\n"]})]}),"\n",(0,r.jsx)(n.h2,{id:"create-a-new-app",children:"Create a new app"}),"\n",(0,r.jsxs)(n.p,{children:["In django, all functionalities are separated into ",(0,r.jsx)(n.strong,{children:"apps"}),". Each app correspond\nto a directory in the ",(0,r.jsx)(n.code,{children:"server/apps"})," folder."]}),"\n",(0,r.jsx)(n.p,{children:"To create a new app:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create a new empty app folder with the django command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run django startapp <app_name>\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Then move this new app folder to the main ",(0,r.jsx)(n.code,{children:"apps"})," folder, so as to have all\napps in the same place."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Inside your new app folder:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a ",(0,r.jsx)(n.code,{children:"urls.py"})," script. You can copy the structure of ",(0,r.jsx)(n.code,{children:"urls.py"})," from other apps."]}),"\n",(0,r.jsxs)(n.li,{children:["Update the ",(0,r.jsx)(n.code,{children:"apps.py"})," script, by replacing ",(0,r.jsx)(n.code,{children:"name = 'app_name'"})," by ",(0,r.jsx)(n.code,{children:"name = 'apps.app_name'"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Inside the ",(0,r.jsx)(n.code,{children:"backend/config"})," folder:"]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["In the ",(0,r.jsx)(n.code,{children:"urls.py"})," script, add a namespace for your app like this:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"url('app_name/', include('apps.app_name.urls', namespace='app_name')),\n"})}),"\n","This will link the url router to your urls.py script in the app you created."]}),"\n",(0,r.jsxs)(n.li,{children:["Then add your app in ",(0,r.jsx)(n.code,{children:"settings/base.py"}),":","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"COMMON_APPS = [ 'apps.app_name', ]\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Finally, we need to update your database:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pipenv run migrate\n"})}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},5162:(e,n,a)=>{a.d(n,{Z:()=>i});a(7294);var r=a(512);const t={tabItem:"tabItem_Ymn6"};var s=a(5893);function i(e){let{children:n,hidden:a,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.Z)(t.tabItem,i),hidden:a,children:n})}},4866:(e,n,a)=>{a.d(n,{Z:()=>w});var r=a(7294),t=a(512),s=a(2466),i=a(6550),o=a(469),l=a(1980),c=a(7392),d=a(12);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:a}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:a,attributes:r,default:t}}=e;return{value:n,label:a,attributes:r,default:t}}))}(a);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function p(e){let{value:n,tabValues:a}=e;return a.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:a}=e;const t=(0,i.k6)(),s=function(e){let{queryString:n=!1,groupId:a}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:n,groupId:a});return[(0,l._X)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})}),[s,t])]}function g(e){const{defaultValue:n,queryString:a=!1,groupId:t}=e,s=h(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s}))),[c,u]=m({queryString:a,groupId:t}),[g,j]=function(e){let{groupId:n}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,s]=(0,d.Nk)(a);return[t,(0,r.useCallback)((e=>{a&&s.set(e)}),[a,s])]}({groupId:t}),f=(()=>{const e=c??g;return p({value:e,tabValues:s})?e:null})();(0,o.Z)((()=>{f&&l(f)}),[f]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),j(e)}),[u,j,s]),tabValues:s}}var j=a(2389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=a(5893);function b(e){let{className:n,block:a,selectedValue:r,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.o5)(),d=e=>{const n=e.currentTarget,a=l.indexOf(n),t=o[a].value;t!==r&&(c(n),i(t))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=l.indexOf(e.currentTarget)+1;n=l[a]??l[0];break}case"ArrowLeft":{const a=l.indexOf(e.currentTarget)-1;n=l[a]??l[l.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.Z)("tabs",{"tabs--block":a},n),children:o.map((e=>{let{value:n,label:a,attributes:s}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>l.push(e),onKeyDown:u,onClick:d,...s,className:(0,t.Z)("tabs__item",f.tabItem,s?.className,{"tabs__item--active":r===n}),children:a??n},n)}))})}function y(e){let{lazy:n,children:a,selectedValue:t}=e;const s=(Array.isArray(a)?a:[a]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===t));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function v(e){const n=g(e);return(0,x.jsxs)("div",{className:(0,t.Z)("tabs-container",f.tabList),children:[(0,x.jsx)(b,{...e,...n}),(0,x.jsx)(y,{...e,...n})]})}function w(e){const n=(0,j.Z)();return(0,x.jsx)(v,{...e,children:u(e.children)},String(n))}},1151:(e,n,a)=>{a.d(n,{Z:()=>o,a:()=>i});var r=a(7294);const t={},s=r.createContext(t);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);